
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Evan Diamente</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;1,300;1,400;1,500&family=Jost:wght@300;400;500&family=DM+Mono:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --cream: #f4efe6;
    --warm-white: #faf7f2;
    --parchment: #ede7da;
    --charcoal: #1e1c18;
    --stone: #7a7367;
    --stone-light: #a09890;
    --accent: #1e3820;
    --sand: #cfc6b2;
    --border: rgba(30,28,24,0.11);
    --border-dark: rgba(30,28,24,0.22);
    --font-serif: 'Cormorant Garamond', Georgia, serif;
    --font-sans: 'Jost', 'Helvetica Neue', Helvetica, sans-serif;
    --font-mono: 'DM Mono', monospace;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }
  body {
    background: var(--warm-white); color: var(--charcoal);
    font-family: var(--font-sans); font-size: 15px;
    line-height: 1.6; font-weight: 300;
    overflow-x: hidden; cursor: none;
  }

  /* CURSOR */
  .cursor { width:7px; height:7px; background:var(--charcoal); border-radius:50%; position:fixed; top:0; left:0; pointer-events:none; z-index:9999; transform:translate(-50%,-50%); transition:width .25s,height .25s; }
  .cursor-ring { width:28px; height:28px; border:1px solid rgba(30,28,24,.3); border-radius:50%; position:fixed; top:0; left:0; pointer-events:none; z-index:9998; transform:translate(-50%,-50%); transition:width .3s,height .3s,border-color .3s; }
  .cursor.hover { width:12px; height:12px; background:var(--accent); }
  .cursor-ring.hover { width:44px; height:44px; border-color:var(--accent); }

  /* NAV */
  nav { position:fixed; top:0; left:0; right:0; z-index:200; padding:30px 52px; display:flex; align-items:center; justify-content:space-between; background:linear-gradient(to bottom,var(--warm-white) 60%,transparent); }
  .nav-logo { font-family:var(--font-serif); font-size:17px; font-weight:400; letter-spacing:0.06em; text-decoration:none; color:var(--charcoal); }
  .nav-logo span { font-style:italic; color:var(--accent); }
  .nav-links { display:flex; gap:38px; align-items:center; }
  .nav-links a { font-size:10px; letter-spacing:0.18em; text-transform:uppercase; color:var(--stone); text-decoration:none; transition:color .25s; }
  .nav-links a:hover { color:var(--charcoal); }
  .nav-cta { font-size:10px; letter-spacing:0.18em; text-transform:uppercase; text-decoration:none; color:var(--charcoal); border-bottom:1px solid var(--charcoal); padding-bottom:2px; transition:color .25s,border-color .25s; }
  .nav-cta:hover { color:var(--accent); border-color:var(--accent); }

<!-- HERO -->
<div class="hero" id="home">
  <div class="hero-left">
    <div class="hero-eyebrow">Indianapolis, IN</div>
    <h1 class="hero-title">
      Real Estate<br>Marketing Professional
    </h1>
    <p class="hero-intro">
      Marketing across 35+ assets inside one of the oldest privately held real estate companies in the country. Trained at Indiana University to understand how organizations work. Spent the years since finding out.
    </p>
    <div class="hero-actions">
      <a href="#work" class="btn-primary">View Work →</a>
      <a href="#contact" class="btn-secondary">Contact</a>
    </div>
  </div>
  <div class="hero-right">
    <div class="hero-portrait">
      <img src="profile.png" alt="Profile photo">
      <div class="hero-portrait-overlay"></div>
    </div>
    <div class="hero-card">
      <div class="hero-stat">
        <div class="stat-n">35<span>+</span></div>
        <div class="stat-l">Assets under<br>portfolio strategy</div>
      </div>
      <div class="hero-stat">
        <div class="stat-n">30</div>
        <div class="stat-l">Websites launched<br>across portfolio</div>
      </div>
      <div class="hero-stat">
        <div class="stat-n">Est<span style="font-size:16px">1921</span></div>
        <div class="stat-l">Edward Rose<br>& Sons</div>
      </div>
    </div>
  </div>
</div>

  /* MARQUEE */
  .marquee-wrap { overflow:hidden; border-bottom:1px solid var(--border); background:var(--parchment); padding:15px 0; }
  .marquee-track { display:flex; width:max-content; animation:marquee 32s linear infinite; }
  .marquee-item { font-family:var(--font-mono); font-size:9.5px; letter-spacing:0.2em; text-transform:uppercase; color:var(--stone); white-space:nowrap; padding:0 40px; }
  .marquee-dot { color:var(--accent); }

  /* SECTIONS */
  section { border-bottom:1px solid var(--border); }
  .sec-head { padding:64px 52px 48px; display:grid; grid-template-columns:200px 1fr; gap:48px; align-items:end; border-bottom:1px solid var(--border); }
  .sec-num { font-family:var(--font-mono); font-size:9px; letter-spacing:0.22em; text-transform:uppercase; color:var(--stone); margin-bottom:10px; display:flex; align-items:center; gap:10px; }
  .sec-num::before { content:''; width:20px; height:1px; background:var(--accent); display:block; }
  .sec-tag { font-family:var(--font-mono); font-size:9px; letter-spacing:0.18em; text-transform:uppercase; color:var(--stone-light); }
  .sec-title { font-family:var(--font-serif); font-size:clamp(32px,3.4vw,52px); font-weight:300; line-height:1.08; }
  .sec-title em { font-style:italic; color:var(--accent); }

  /* WORK GRID */
  .work-grid { display:grid; grid-template-columns:1fr 1fr; }
  .work-item { border-right:1px solid var(--border); border-bottom:1px solid var(--border); opacity:0; transform:translateY(18px); transition:opacity .7s ease,transform .7s ease; }
  .work-item:nth-child(2n) { border-right:none; }
  .work-item.full-width { grid-column:1/-1; border-right:none; }
  .work-item.visible { opacity:1; transform:translateY(0); }

  /* Featured iframe card */
  .work-featured { display:grid; grid-template-columns:1fr 1fr; }
  .work-featured-preview { position:relative; overflow:hidden; border-right:1px solid var(--border); min-height:520px; background:#1a1a1a; }
  .iframe-device { position:absolute; inset:0; display:flex; flex-direction:column; }
  .iframe-bar { background:#2a2a2a; padding:10px 16px; display:flex; align-items:center; gap:10px; flex-shrink:0; }
  .iframe-dots { display:flex; gap:6px; }
  .iframe-dot { width:10px; height:10px; border-radius:50%; }
  .iframe-dot:nth-child(1) { background:#ff5f57; }
  .iframe-dot:nth-child(2) { background:#febc2e; }
  .iframe-dot:nth-child(3) { background:#28c840; }
  .iframe-url { flex:1; background:#3a3a3a; border-radius:4px; padding:5px 12px; font-family:var(--font-mono); font-size:9px; letter-spacing:0.06em; color:rgba(255,255,255,.4); }
  .iframe-wrap { flex:1; position:relative; overflow:hidden; }
  .iframe-wrap iframe { width:200%; height:200%; transform:scale(0.5); transform-origin:top left; border:none; pointer-events:none; }
  .iframe-overlay { position:absolute; inset:0; cursor:pointer; display:flex; align-items:center; justify-content:center; background:transparent; transition:background .3s; }
  .iframe-overlay:hover { background:rgba(26,26,26,.18); }
  .iframe-live-btn { opacity:0; transform:translateY(8px); font-family:var(--font-mono); font-size:9px; letter-spacing:0.2em; text-transform:uppercase; color:white; background:rgba(0,0,0,.65); padding:10px 20px; backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,.2); transition:opacity .25s,transform .25s; }
  .iframe-overlay:hover .iframe-live-btn { opacity:1; transform:translateY(0); }

  /* Modal */
  .site-modal { display:none; position:fixed; inset:0; z-index:500; background:rgba(20,18,14,.85); backdrop-filter:blur(6px); align-items:center; justify-content:center; }
  .site-modal.open { display:flex; }
  .modal-inner { width:90vw; height:88vh; max-width:1200px; background:var(--charcoal); display:flex; flex-direction:column; overflow:hidden; }
  .modal-bar { background:#2a2a2a; padding:12px 20px; display:flex; align-items:center; gap:14px; flex-shrink:0; }
  .modal-close { width:14px; height:14px; border-radius:50%; background:#ff5f57; cursor:pointer; display:flex; align-items:center; justify-content:center; font-size:9px; color:rgba(0,0,0,.5); font-weight:700; border:none; transition:filter .2s; }
  .modal-close:hover { filter:brightness(1.2); }
  .modal-url-bar { flex:1; background:#3a3a3a; border-radius:4px; padding:6px 14px; font-family:var(--font-mono); font-size:10px; letter-spacing:0.06em; color:rgba(255,255,255,.5); display:flex; align-items:center; gap:10px; }
  .modal-url-dot { width:6px; height:6px; border-radius:50%; background:#28c840; flex-shrink:0; }
  .modal-ext-link { margin-left:auto; font-family:var(--font-mono); font-size:9px; letter-spacing:0.14em; text-transform:uppercase; color:rgba(255,255,255,.35); text-decoration:none; transition:color .2s; }
  .modal-ext-link:hover { color:rgba(255,255,255,.7); }
  .modal-iframe-wrap { flex:1; overflow:hidden; }
  .modal-iframe-wrap iframe { width:100%; height:100%; border:none; }

  /* Work cards — stripped */
  .work-featured-body { padding:56px 52px; display:flex; flex-direction:column; justify-content:center; }
  .work-body { padding:40px 44px 48px; }
  .work-cat { font-family:var(--font-mono); font-size:9px; letter-spacing:0.2em; text-transform:uppercase; color:var(--stone); margin-bottom:12px; display:flex; align-items:center; gap:10px; }
  .work-cat::before { content:''; width:14px; height:1px; background:var(--accent); display:block; }
  .work-title { font-family:var(--font-serif); font-size:26px; font-weight:400; line-height:1.2; margin-bottom:6px; }
  .work-title-lg { font-family:var(--font-serif); font-size:clamp(26px,2.8vw,42px); font-weight:300; line-height:1.12; margin-bottom:6px; }
  .work-title-lg em { font-style:italic; color:var(--accent); }
  .work-role-note { font-family:var(--font-mono); font-size:9px; letter-spacing:0.14em; text-transform:uppercase; color:var(--stone-light); margin-bottom:20px; padding:10px 0; border-top:1px solid var(--border); border-bottom:1px solid var(--border); }
  .work-pills { display:flex; flex-wrap:wrap; gap:6px; margin-bottom:24px; }
  .pill { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.14em; text-transform:uppercase; color:var(--stone); border:1px solid var(--border); padding:5px 12px; }
  .work-link { font-size:10px; letter-spacing:0.16em; text-transform:uppercase; color:var(--charcoal); text-decoration:none; border-bottom:1px solid var(--border-dark); padding-bottom:2px; display:inline-flex; align-items:center; gap:8px; transition:color .25s,border-color .25s; cursor:pointer; }
  .work-link:hover { color:var(--accent); border-color:var(--accent); }
  .work-img { aspect-ratio:16/9; overflow:hidden; position:relative; }
  .work-img-fill { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; transition:transform .8s cubic-bezier(.25,.46,.45,.94); }
  .work-item:hover .work-img-fill { transform:scale(1.04); }
  .work-img-label { font-family:var(--font-mono); font-size:9px; letter-spacing:0.2em; text-transform:uppercase; color:rgba(122,115,103,0.45); border:1px solid rgba(122,115,103,0.2); padding:10px 16px; }
  .ph-a { background:linear-gradient(145deg,#ddd5c4,#c9bfad); }
  .ph-b { background:linear-gradient(145deg,#ccd3c6,#b8c0b0); }
  .ph-c { background:linear-gradient(145deg,#d4cbc0,#c0b4a8); }
  .ph-d { background:linear-gradient(145deg,#ccc3b8,#b8ada0); }

  /* WEBSITES GRID */
  .sites-grid { display:grid; grid-template-columns:repeat(2,1fr); }
  .site-card { border-right:1px solid var(--border); border-bottom:1px solid var(--border); opacity:0; transform:translateY(14px); transition:opacity .6s ease,transform .6s ease; }
  .site-card:nth-child(2n) { border-right:none; }
  .site-card.visible { opacity:1; transform:translateY(0); }
  .site-preview { position:relative; overflow:hidden; background:#1a1a1a; aspect-ratio:16/10; }
  .site-preview .iframe-device { position:absolute; inset:0; display:flex; flex-direction:column; }
  .site-preview .iframe-bar { background:#2a2a2a; padding:8px 14px; display:flex; align-items:center; gap:8px; flex-shrink:0; }
  .site-preview .iframe-dots { display:flex; gap:5px; }
  .site-preview .iframe-dot { width:8px; height:8px; border-radius:50%; }
  .site-preview .iframe-url { flex:1; background:#3a3a3a; border-radius:3px; padding:4px 10px; font-family:var(--font-mono); font-size:8px; letter-spacing:0.06em; color:rgba(255,255,255,.4); }
  .site-preview .iframe-wrap { flex:1; position:relative; overflow:hidden; }
  .site-preview .iframe-wrap iframe { width:200%; height:200%; transform:scale(0.5); transform-origin:top left; border:none; pointer-events:none; }
  .site-preview .iframe-overlay { position:absolute; inset:0; cursor:pointer; display:flex; align-items:center; justify-content:center; background:transparent; transition:background .3s; }
  .site-preview .iframe-overlay:hover { background:rgba(0,0,0,.2); }
  .site-preview .iframe-live-btn { opacity:0; transform:translateY(6px); font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.18em; text-transform:uppercase; color:white; background:rgba(0,0,0,.65); padding:8px 16px; backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,.2); transition:opacity .25s,transform .25s; }
  .site-preview .iframe-overlay:hover .iframe-live-btn { opacity:1; transform:translateY(0); }
  .site-info { padding:24px 28px 28px; }
  .site-name { font-family:var(--font-serif); font-size:20px; font-weight:400; margin-bottom:4px; }
  .site-url { font-family:var(--font-mono); font-size:9px; letter-spacing:0.14em; color:var(--stone-light); text-transform:lowercase; }

  /* SCOPE — stripped down */
  .scope-strip { padding:64px 52px; display:grid; grid-template-columns:repeat(4,1fr); gap:2px; }
  .scope-cell { background:var(--cream); padding:32px 28px 28px; border:1px solid var(--border); }
  .scope-n { font-family:var(--font-serif); font-size:52px; font-weight:300; line-height:1; }
  .scope-n sup { font-size:22px; color:var(--accent); vertical-align:super; }
  .scope-l { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.16em; text-transform:uppercase; color:var(--stone); margin-top:8px; line-height:1.5; }

  .platform-grid { padding:0 52px 64px; display:grid; grid-template-columns:repeat(4,1fr); gap:0; border-top:1px solid var(--border); }
  .platform-row { display:flex; justify-content:space-between; align-items:center; padding:14px 0; border-top:1px solid var(--border); }
  .platform-row:last-child { border-bottom:1px solid var(--border); }
  .platform-name { font-size:13px; }
  .platform-tag { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.14em; text-transform:uppercase; color:var(--stone); border:1px solid var(--border); padding:4px 10px; }
  .platform-col { padding:0 28px; border-right:1px solid var(--border); padding-top:32px; }
  .platform-col:first-child { padding-left:0; }
  .platform-col:last-child { border-right:none; }
  .platform-col-title { font-family:var(--font-serif); font-size:15px; font-weight:400; margin-bottom:16px; }
  .platform-tag-list { display:flex; flex-direction:column; }
  .ptag { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.12em; text-transform:uppercase; color:var(--stone); padding:7px 0; border-top:1px solid var(--border); }
  .ptag:last-child { border-bottom:1px solid var(--border); }

  /* AWARDS */
  .awards-strip { background:var(--parchment); padding:52px 52px; display:grid; grid-template-columns:1fr 1fr 1fr; }
  .award-item { padding:0 44px; border-right:1px solid var(--border); }
  .award-item:first-child { padding-left:0; }
  .award-item:last-child { border-right:none; }
  .award-mark { width:24px; height:1px; background:var(--accent); margin-bottom:20px; }
  .award-org { font-family:var(--font-mono); font-size:9px; letter-spacing:0.18em; text-transform:uppercase; color:var(--stone); margin-bottom:8px; }
  .award-title { font-family:var(--font-serif); font-size:17px; font-weight:400; line-height:1.3; margin-bottom:8px; }
  .award-year { font-family:var(--font-mono); font-size:9px; letter-spacing:0.12em; color:var(--stone-light); }

  /* BLUEPRINT GAME */
  .game-section { padding:80px 52px; background:var(--warm-white); border-bottom:1px solid var(--border); }
  .game-header { display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:48px; }
  .game-title { font-family:var(--font-serif); font-size:clamp(28px,3vw,44px); font-weight:300; line-height:1.1; }
  .game-title em { font-style:italic; color:var(--accent); }
  .game-sub { font-family:var(--font-mono); font-size:9px; letter-spacing:0.18em; text-transform:uppercase; color:var(--stone); }
  .game-container { position:relative; }
  .blueprint-canvas { display:block; width:100%; max-width:900px; margin:0 auto; border:1px solid var(--border); background:#f0ebe0; cursor:crosshair; }
  .game-controls { display:flex; gap:12px; justify-content:center; margin-top:20px; flex-wrap:wrap; }
  .btn-swatch { display:inline-block; width:9px; height:9px; border-radius:50%; margin-right:7px; flex-shrink:0; vertical-align:middle; }
  .room-btn {
    font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.14em; text-transform:uppercase;
    border:1px solid var(--border); padding:9px 18px; background:transparent; cursor:pointer;
    color:var(--stone); transition:all .2s;
  }
  .room-btn:hover, .room-btn.active { background:var(--charcoal); color:var(--cream); border-color:var(--charcoal); }
  .game-reset { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.14em; text-transform:uppercase; border:1px solid var(--border-dark); padding:9px 18px; background:transparent; cursor:pointer; color:var(--stone); transition:all .2s; }
  .game-reset:hover { border-color:var(--accent); color:var(--accent); }
  .game-sub-wrap { display:flex; align-items:flex-end; padding-bottom:6px; }
  .blueprint-canvas { display:block; width:100%; border:1px solid var(--border); background:#f0ebe0; cursor:crosshair; touch-action:none; }
  .game-hint { font-family:var(--font-mono); font-size:9px; letter-spacing:0.12em; color:var(--stone-light); text-align:center; margin-top:14px; }

  /* CONTACT */
  .contact-layout { display:grid; grid-template-columns:1fr 1fr; }
  .contact-left { padding:80px 64px 80px 52px; border-right:1px solid var(--border); }
  .contact-left h2 { font-family:var(--font-serif); font-size:clamp(40px,5vw,68px); font-weight:300; line-height:1.05; margin-bottom:24px; }
  .contact-left h2 em { font-style:italic; color:var(--accent); }
  .contact-left p { font-size:13px; color:var(--stone); line-height:1.9; max-width:300px; letter-spacing:0.01em; }
  .contact-right { padding:80px 52px 80px 64px; display:flex; flex-direction:column; justify-content:center; }
  .contact-item { display:flex; align-items:center; justify-content:space-between; padding:22px 0; border-bottom:1px solid var(--border); text-decoration:none; color:var(--charcoal); transition:padding-left .25s; }
  .contact-item:first-child { border-top:1px solid var(--border); }
  .contact-item:hover { padding-left:12px; }
  .ci-label { font-size:13px; }
  .ci-type { font-family:var(--font-mono); font-size:8.5px; letter-spacing:0.16em; text-transform:uppercase; color:var(--stone); transition:color .25s; display:flex; align-items:center; gap:8px; }
  .contact-item:hover .ci-type { color:var(--accent); }
  .ci-arrow { transition:transform .25s; display:inline-block; }
  .contact-item:hover .ci-arrow { transform:translateX(5px); }

  /* FOOTER */
  footer { padding:28px 52px; display:flex; justify-content:space-between; align-items:center; border-top:1px solid var(--border); }
  .footer-copy { font-family:var(--font-mono); font-size:9px; letter-spacing:0.12em; color:var(--stone); }
  .footer-brand { font-family:var(--font-serif); font-size:14px; font-weight:300; color:var(--stone); }

  @keyframes fadeUp { from { opacity:0; transform:translateY(22px); } to { opacity:1; transform:translateY(0); } }
  @keyframes fadeIn { from { opacity:0; } to { opacity:1; } }
  @keyframes marquee { from { transform:translateX(0); } to { transform:translateX(-50%); } }
  .reveal { opacity:0; transform:translateY(18px); transition:opacity .75s ease,transform .75s ease; }
  .reveal.visible { opacity:1; transform:translateY(0); }
  .reveal-d1 { transition-delay:.12s; }

  @media (max-width:960px) {
    nav { padding:22px 24px; }
    .nav-links { display:none; }
    .hero { grid-template-columns:1fr; }
    .hero-right { display:none; }
    .hero-left { padding:130px 24px 64px; }
    .work-grid, .sites-grid, .contact-layout { grid-template-columns:1fr; }
    .work-featured { grid-template-columns:1fr; }
    .work-featured-preview { min-height:240px; }
    .scope-strip { grid-template-columns:1fr 1fr; }
    .platform-grid { grid-template-columns:1fr 1fr; }
    .awards-strip { grid-template-columns:1fr; gap:32px; }
    .sec-head { grid-template-columns:1fr; }
    .contact-left { border-right:none; }
  }
</style>
</head>
<body>

<div class="cursor" id="cur"></div>
<div class="cursor-ring" id="ring"></div>

<!-- MODALS -->
<div class="site-modal" id="siteModal">
  <div class="modal-inner">
    <div class="modal-bar">
      <button class="modal-close" id="modalClose">✕</button>
      <div style="width:14px;height:14px;border-radius:50%;background:#febc2e;"></div>
      <div style="width:14px;height:14px;border-radius:50%;background:#28c840;"></div>
      <div class="modal-url-bar">
        <div class="modal-url-dot"></div>
        <span id="modalUrlText">iconcarmel.rcmvctest.com</span>
        <a class="modal-ext-link" id="modalExtLink" href="#" target="_blank">Open in new tab ↗</a>
      </div>
    </div>
    <div class="modal-iframe-wrap">
      <iframe id="modalIframe" src="" title="Site Preview" allowfullscreen></iframe>
    </div>
  </div>
</div>

<nav>
  <a class="nav-logo" href="#">Evan Diamente<span>.</span></a>
  <div class="nav-links">
    <a href="#work">Work</a>
    <a href="#sites">Sites</a>
    <a href="#play">Play</a>
    <a href="#contact" class="nav-cta">Contact →</a>
  </div>
</nav>

<!-- HERO -->
<div class="hero" id="home">
  <div class="hero-left">
    <div class="hero-eyebrow">Indianapolis, IN</div>
    <h1 class="hero-title">
      Real Estate<br>Marketing Professional
    </h1>
    <p class="hero-intro">
      Marketing across 35+ assets inside one of the oldest privately held real estate companies in the country. Trained at Indiana University to understand how organizations work. Spent the years since finding out.
    </p>
    <div class="hero-actions">
      <a href="#work" class="btn-primary">View Work →</a>
      <a href="#contact" class="btn-secondary">Contact</a>
    </div>
  </div>
  <div class="hero-right">
    <div class="hero-portrait">
      <img src: >
      <div class="hero-portrait-overlay"></div>
    </div>
    <div class="hero-card">
      <div class="hero-stat">
        <div class="stat-n">35<span>+</span></div>
        <div class="stat-l">Assets under<br>portfolio strategy</div>
      </div>
      <div class="hero-stat">
        <div class="stat-n">30</div>
        <div class="stat-l">Websites launched<br>across portfolio</div>
      </div>
      <div class="hero-stat">
        <div class="stat-n">Est<span style="font-size:16px">1921</span></div>
        <div class="stat-l">Edward Rose<br>& Sons</div>
      </div>
    </div>
  </div>
</div>

<!-- MARQUEE -->
<div class="marquee-wrap">
  <div class="marquee-track">
    <span class="marquee-item">Real Estate Marketing <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Portfolio Strategy <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Project Management <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Google Ads & SEM <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Brand Systems <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Performance Reporting <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Web & UX Design <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Lease-Up Execution <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Vendor Management <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Real Estate Marketing <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Portfolio Strategy <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Project Management <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Google Ads & SEM <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Brand Systems <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Performance Reporting <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Web & UX Design <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Lease-Up Execution <span class="marquee-dot"> ✦ </span></span>
    <span class="marquee-item">Vendor Management <span class="marquee-dot"> ✦ </span></span>
  </div>
</div>

<!-- WORK -->
<section id="work">
  <div class="sec-head reveal">
    <div>
      <div class="sec-num">01</div>
      <div class="sec-tag">Selected Work</div>
    </div>
    <div>
      <h2 class="sec-title">The<br><em>work.</em></h2>
    </div>
  </div>
  <div class="work-grid">

    <div class="work-item full-width reveal">
      <div class="work-featured">
        <div class="work-featured-preview">
          <div class="iframe-device">
            <div class="iframe-bar">
              <div class="iframe-dots"><div class="iframe-dot"></div><div class="iframe-dot"></div><div class="iframe-dot"></div></div>
              <div class="iframe-url">iconcarmel.rcmvctest.com</div>
            </div>
            <div class="iframe-wrap">
              <iframe src="https://iconcarmel.rcmvctest.com/" loading="lazy" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
              <div class="iframe-overlay" data-url="https://iconcarmel.rcmvctest.com/" data-label="iconcarmel.rcmvctest.com">
                <div class="iframe-live-btn">Explore Site ↗</div>
              </div>
            </div>
          </div>
        </div>
        <div class="work-featured-body">
          <div class="work-cat">Brand & Web · Luxury Lease-Up · Carmel, IN</div>
          <div class="work-title-lg">Icon on Main —<br><em>Full Project Lead</em></div>
          <div class="work-role-note">Vendor · Brand direction · Timeline · Launch · Edward Rose & Sons</div>
          <div class="work-pills">
            <span class="pill">Project Management</span>
            <span class="pill">Brand Direction</span>
            <span class="pill">Vendor Management</span>
            <span class="pill">UX Architecture</span>
            <span class="pill">Luxury Lease-Up</span>
          </div>
          <span class="work-link open-modal" data-url="https://iconcarmel.rcmvctest.com/" data-label="iconcarmel.rcmvctest.com">View Live Site ↗</span>
        </div>
      </div>
    </div>

    <div class="work-item reveal">
      <div class="work-img"><div class="work-img-fill ph-a"><span class="work-img-label">Add image</span></div></div>
      <div class="work-body">
        <div class="work-cat">Web & Brand · 2023–2024</div>
        <div class="work-title">30 Websites. One Standard.</div>
        <div class="work-role-note">Training & standardization · Edward Rose & Sons</div>
        <div class="work-pills">
          <span class="pill">UX Strategy</span><span class="pill">Brand Standards</span>
          <span class="pill">HTML/CSS</span><span class="pill">Team Training</span>
        </div>
      </div>
    </div>

    <div class="work-item reveal reveal-d1">
      <div class="work-img"><div class="work-img-fill ph-b"><span class="work-img-label">Add image</span></div></div>
      <div class="work-body">
        <div class="work-cat">Search Strategy · Ongoing</div>
        <div class="work-title">Google Partnership & Portfolio SEM</div>
        <div class="work-role-note">Direct collaboration with Google's strategy team</div>
        <div class="work-pills">
          <span class="pill">Google Marketing Platform</span>
          <span class="pill">SEM</span><span class="pill">Demand Capture</span>
        </div>
      </div>
    </div>

    <div class="work-item reveal">
      <div class="work-img"><div class="work-img-fill ph-c"><span class="work-img-label">Add image</span></div></div>
      <div class="work-body">
        <div class="work-cat">Analytics · Ongoing</div>
        <div class="work-title">Portfolio Performance Reporting</div>
        <div class="work-role-note">Built & maintained · Edward Rose & Sons</div>
        <div class="work-pills">
          <span class="pill">REBA</span><span class="pill">Yardi</span>
          <span class="pill">CoStar</span><span class="pill">Data Analysis</span>
        </div>
      </div>
    </div>

    <div class="work-item reveal reveal-d1">
      <div class="work-img"><div class="work-img-fill ph-d"><span class="work-img-label">Add image</span></div></div>
      <div class="work-body">
        <div class="work-cat">Communications · 2023</div>
        <div class="work-title">Resident Onboarding — 3,000+ Move-ins</div>
        <div class="work-role-note">Contributed to standardization · Edward Rose & Sons</div>
        <div class="work-pills">
          <span class="pill">Brand Voice</span>
          <span class="pill">Resident Experience</span><span class="pill">Standardization</span>
        </div>
      </div>
    </div>

  </div>
</section>

<!-- WEBSITES -->
<section id="sites">
  <div class="sec-head reveal">
    <div>
      <div class="sec-num">02</div>
      <div class="sec-tag">Portfolio Websites</div>
    </div>
    <div>
      <h2 class="sec-title">Live site samples.</em></h2>
    </div>
  </div>
  <div class="sites-grid">

    <div class="site-card reveal">
      <div class="site-preview">
        <div class="iframe-device">
          <div class="iframe-bar">
            <div class="iframe-dots"><div class="iframe-dot"></div><div class="iframe-dot"></div><div class="iframe-dot"></div></div>
            <div class="iframe-url">ironwoodflats.com</div>
          </div>
          <div class="iframe-wrap">
            <iframe src="https://ironwoodflats.com/" loading="lazy" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
            <div class="iframe-overlay" data-url="https://ironwoodflats.com/" data-label="ironwoodflats.com">
              <div class="iframe-live-btn">Explore Site ↗</div>
            </div>
          </div>
        </div>
      </div>
      <div class="site-info">
        <div class="site-name">Ironwood Flats</div>
        <div class="site-url">ironwoodflats.com</div>
      </div>
    </div>

    <div class="site-card reveal reveal-d1">
      <div class="site-preview">
        <div class="iframe-device">
          <div class="iframe-bar">
            <div class="iframe-dots"><div class="iframe-dot"></div><div class="iframe-dot"></div><div class="iframe-dot"></div></div>
            <div class="iframe-url">nuvoflats.com</div>
          </div>
          <div class="iframe-wrap">
            <iframe src="https://nuvoflats.com/" loading="lazy" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
            <div class="iframe-overlay" data-url="https://nuvoflats.com/" data-label="nuvoflats.com">
              <div class="iframe-live-btn">Explore Site ↗</div>
            </div>
          </div>
        </div>
      </div>
      <div class="site-info">
        <div class="site-name">Nuvo Flats</div>
        <div class="site-url">nuvoflats.com</div>
      </div>
    </div>

    <div class="site-card reveal">
      <div class="site-preview">
        <div class="iframe-device">
          <div class="iframe-bar">
            <div class="iframe-dots"><div class="iframe-dot"></div><div class="iframe-dot"></div><div class="iframe-dot"></div></div>
            <div class="iframe-url">avenueatpolaris.com</div>
          </div>
          <div class="iframe-wrap">
            <iframe src="https://avenueatpolaris.com/" loading="lazy" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
            <div class="iframe-overlay" data-url="https://avenueatpolaris.com/" data-label="avenueatpolaris.com">
              <div class="iframe-live-btn">Explore Site ↗</div>
            </div>
          </div>
        </div>
      </div>
      <div class="site-info">
        <div class="site-name">Avenue at Polaris</div>
        <div class="site-url">avenueatpolaris.com</div>
      </div>
    </div>

    <div class="site-card reveal reveal-d1">
      <div class="site-preview">
        <div class="iframe-device">
          <div class="iframe-bar">
            <div class="iframe-dots"><div class="iframe-dot"></div><div class="iframe-dot"></div><div class="iframe-dot"></div></div>
            <div class="iframe-url">bavarianvillageindy.com</div>
          </div>
          <div class="iframe-wrap">
            <iframe src="https://bavarianvillageindy.com/" loading="lazy" sandbox="allow-scripts allow-same-origin allow-forms"></iframe>
            <div class="iframe-overlay" data-url="https://bavarianvillageindy.com/" data-label="bavarianvillageindy.com">
              <div class="iframe-live-btn">Explore Site ↗</div>
            </div>
          </div>
        </div>
      </div>
      <div class="site-info">
        <div class="site-name">Bavarian Village</div>
        <div class="site-url">bavarianvillageindy.com</div>
      </div>
    </div>

  </div>
</section>

<!-- Highlights -->
<div class="awards-strip reveal">
  <div class="award-item">
    <div class="award-mark"></div>
    <div class="award-org">Indiana Apartment Association</div>
    <div class="award-title">Award of Excellence Finalist — Corporate Support, Marketing</div>
    <div class="award-year">2025</div>
  </div>
  <div class="award-item">
    <div class="award-mark"></div>
    <div class="award-org">National Apartment Association</div>
    <div class="award-title">Active Member</div>
    <div class="award-year">2023 – Present</div>
  </div>
  <div class="award-item">
    <div class="award-mark"></div>
    <div class="award-org">Indiana University O'Neill School</div>
    <div class="award-title">B.S. Management (Public & Private Sectors)</div>
    <div class="award-year">Class of 2023</div>
  </div>
</div>

<!-- BLUEPRINT GAME -->
<section id="play">
  <div class="game-section">
    <div class="game-header reveal">
      <div>
        <div class="game-title">Build your own market.</em></div>
      </div>
      <div class="game-sub-wrap">
        <div class="game-sub">Click to place · Right-click to remove · Shift+click to stack · Rotate to orbit</div>
      </div>
    </div>
    <div class="reveal">
      <canvas class="blueprint-canvas" id="blueprintCanvas"></canvas>
      <div class="game-controls">
        <button class="room-btn active" data-type="tower" title="High-Rise — 9 floors"><span class="btn-swatch" style="background:#1e3820"></span>High-Rise</button>
        <button class="room-btn" data-type="mid" title="Mid-Rise — 5 floors"><span class="btn-swatch" style="background:#3d5c38"></span>Mid-Rise</button>
        <button class="room-btn" data-type="low" title="Low-Rise — 2 floors"><span class="btn-swatch" style="background:#6a8e65"></span>Low-Rise</button>
        <button class="room-btn" data-type="amenity" title="Amenity — 1 floor"><span class="btn-swatch" style="background:#0C3649"></span>Amenity</button>
        <button class="room-btn" data-type="retail" title="Retail — 1 floor"><span class="btn-swatch" style="background:#8B4513"></span>Retail</button>
        <button class="room-btn" data-type="parking" title="Parking — 2 floors"><span class="btn-swatch" style="background:#b8b0a0"></span>Parking</button>
        <button class="game-reset" id="resetCanvas">Clear ↺</button>
        <button class="room-btn" id="rotateLeft" title="Rotate left 90°">↶ Rotate</button>
        <button class="room-btn" id="rotateRight" title="Rotate right 90°">Rotate ↷</button>
      </div>
    </div>
  </div>
</section>

<script>
// ── Cursor
const cur = document.getElementById('cur');
const ring = document.getElementById('ring');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;});
function addHover(el){
  el.addEventListener('mouseenter',()=>{cur.classList.add('hover');ring.classList.add('hover');});
  el.addEventListener('mouseleave',()=>{cur.classList.remove('hover');ring.classList.remove('hover');});
}
document.querySelectorAll('a,button,.iframe-overlay,.work-link,.room-btn,.game-reset').forEach(addHover);
(function animCur(){
  cur.style.left=mx+'px';cur.style.top=my+'px';
  rx+=(mx-rx)*.11;ry+=(my-ry)*.11;
  ring.style.left=rx+'px';ring.style.top=ry+'px';
  requestAnimationFrame(animCur);
})();

// ── Modal
const modal=document.getElementById('siteModal');
const modalIframe=document.getElementById('modalIframe');
const modalUrlText=document.getElementById('modalUrlText');
const modalExtLink=document.getElementById('modalExtLink');
function openModal(url,label){
  modalIframe.src=url;
  modalUrlText.textContent=label;
  modalExtLink.href=url;
  modal.classList.add('open');
  document.body.style.overflow='hidden';
}
function closeModal(){
  modal.classList.remove('open');
  document.body.style.overflow='';
  setTimeout(()=>{modalIframe.src='';},300);
}
document.querySelectorAll('.iframe-overlay').forEach(el=>{
  el.addEventListener('click',()=>openModal(el.dataset.url,el.dataset.label));
});
document.querySelectorAll('.open-modal').forEach(el=>{
  el.addEventListener('click',e=>{e.preventDefault();openModal(el.dataset.url,el.dataset.label);});
});
document.getElementById('modalClose').addEventListener('click',closeModal);
modal.addEventListener('click',e=>{if(e.target===modal)closeModal();});
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeModal();});

// ── Scroll reveals
const io=new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(!e.isIntersecting)return;
    e.target.classList.add('visible');
  });
},{threshold:0.08});
document.querySelectorAll('.reveal,.work-item,.site-card').forEach(r=>io.observe(r));

// ══════════════════════════════════════════
// ISOMETRIC CITY BUILDER — with 360° rotation
// ══════════════════════════════════════════
const canvas = document.getElementById('blueprintCanvas');
const ctx = canvas.getContext('2d');

// Responsive sizing
function setCanvasSize(){
  const maxW = Math.min(window.innerWidth - 104, 1000);
  const H = Math.round(maxW * 0.56);
  canvas.style.width = maxW + 'px';
  canvas.style.height = H + 'px';
  const dpr = window.devicePixelRatio || 1;
  canvas.width = maxW * dpr;
  canvas.height = H * dpr;
  ctx.scale(dpr, dpr);
  CONF.W = maxW;
  CONF.H = H;
  CONF.ORIGIN_X = maxW * 0.5;
  CONF.ORIGIN_Y = H * 0.12;
  CONF.TILE_W = Math.round(maxW * 0.082);
  CONF.TILE_H = Math.round(maxW * 0.041);
}

const CONF = { W:900, H:504, ORIGIN_X:450, ORIGIN_Y:90, TILE_W:64, TILE_H:32, COLS:10, ROWS:10 };

// ── Building type definitions
// Each type has colors for all 4 face directions: top, A-face, B-face
// A-face = right screen side, B-face = left screen side
// At different rotations these map to different world faces
const TYPES = {
  tower:   { label:'High-Rise', floors:8,
    top:'#3a5532',
    faceNE:'#1a2e18', faceSE:'#243d22', faceSW:'#1e3420', faceNW:'#2a4225' },
  mid:     { label:'Mid-Rise',  floors:5,
    top:'#4e7248',
    faceNE:'#2d4428', faceSE:'#3a5535', faceSW:'#324a30', faceNW:'#3e5c3a' },
  low:     { label:'Low-Rise',  floors:3,
    top:'#7aa070',
    faceNE:'#4a6a45', faceSE:'#5a7a52', faceSW:'#507048', faceNW:'#5e7855' },
  amenity: { label:'Amenity',   floors:2,
    top:'#1a4d63',
    faceNE:'#061c2d', faceSE:'#0c3048', faceSW:'#091e2f', faceNW:'#0e3550' },
  retail:  { label:'Retail',    floors:2,
    top:'#A0521a',
    faceNE:'#4a2509', faceSE:'#6B3510', faceSW:'#522a0b', faceNW:'#703a14' },
  parking: { label:'Parking',   floors:1,
    top:'#c8c0b0',
    faceNE:'#787060', faceSE:'#989080', faceSW:'#808070', faceNW:'#9a9285' },
};

let grid = {};       // key: "col,row" -> array of {type}
let currentType = 'tower';
let hoveredCell = null;
let isDragging = false;

// ── Rotation state: 0=NE view, 1=SE view, 2=SW view, 3=NW view
// (the "viewAngle" represents which world-corner the viewer stands at)
let viewAngle = 0; // 0..3

// ── Rotate a grid coordinate based on viewAngle
// At angle 0: col goes right-down, row goes left-down (standard)
// At angle 1: col goes left-down, row goes right-up (90° CW)
// At angle 2: col goes left-up, row goes right-down (180°)
// At angle 3: col goes right-up, row goes left-down (270° CW)
function transformCoord(c, r) {
  const N = CONF.COLS; // assuming square grid
  switch(viewAngle) {
    case 0: return { tc: c,       tr: r       };
    case 1: return { tc: r,       tr: N-1-c   };
    case 2: return { tc: N-1-c,   tr: N-1-r   };
    case 3: return { tc: N-1-r,   tr: c       };
  }
}

function isoToScreen(tc, tr){
  const x = CONF.ORIGIN_X + (tc - tr) * (CONF.TILE_W / 2);
  const y = CONF.ORIGIN_Y + (tc + tr) * (CONF.TILE_H / 2);
  return {x, y};
}

// Convert screen coords back to world (c,r) accounting for rotation
function screenToWorld(sx, sy){
  const dx = sx - CONF.ORIGIN_X;
  const dy = sy - CONF.ORIGIN_Y;
  const tw2 = CONF.TILE_W / 2, th2 = CONF.TILE_H / 2;
  // Get transformed tile coords
  const tc = Math.round((dx / tw2 + dy / th2) / 2);
  const tr = Math.round((dy / th2 - dx / tw2) / 2);
  // Invert transform to get world coords
  const N = CONF.COLS;
  let c, r;
  switch(viewAngle) {
    case 0: c = tc;       r = tr;       break;
    case 1: c = N-1-tr;   r = tc;       break;
    case 2: c = N-1-tc;   r = N-1-tr;   break;
    case 3: c = tr;       r = N-1-tc;   break;
  }
  return {col: c, row: r};
}

function drawTopFace(x, y, tileW, tileH, fillColor, strokeColor){
  ctx.beginPath();
  ctx.moveTo(x,           y);
  ctx.lineTo(x + tileW/2, y + tileH/2);
  ctx.lineTo(x,           y + tileH);
  ctx.lineTo(x - tileW/2, y + tileH/2);
  ctx.closePath();
  ctx.fillStyle = fillColor;
  ctx.fill();
  ctx.strokeStyle = strokeColor;
  ctx.lineWidth = 0.6;
  ctx.stroke();
}

// Get the two visible face colors for the current viewAngle
// Right screen face and Left screen face colors
function getFaceColors(def) {
  // At each viewAngle, viewer sees two different world faces
  // viewAngle 0 (NE view): right screen = NE face, left screen = NW face
  // viewAngle 1 (SE view): right screen = SE face, left screen = NE face
  // viewAngle 2 (SW view): right screen = SW face, left screen = SE face
  // viewAngle 3 (NW view): right screen = NW face, left screen = SW face
  const faceMap = [
    { right: def.faceNE, left: def.faceNW },
    { right: def.faceSE, left: def.faceNE },
    { right: def.faceSW, left: def.faceSE },
    { right: def.faceNW, left: def.faceSW },
  ];
  return faceMap[viewAngle];
}

function drawBuilding(col, row, type, alpha, stackBase){
  const def = TYPES[type];
  const FH = 18;
  const totalH = def.floors * FH;
  const baseH  = (stackBase || 0) * FH;

  const {tc, tr} = transformCoord(col, row);
  const {x, y} = isoToScreen(tc, tr);
  const tw = CONF.TILE_W, th = CONF.TILE_H;

  if(alpha !== undefined) ctx.globalAlpha = alpha;

  // Tile diamond vertices at GROUND level
  const gBack  = { px: x,       py: y          - baseH };
  const gRight = { px: x+tw/2,  py: y + th/2   - baseH };
  const gFront = { px: x,       py: y + th     - baseH };
  const gLeft  = { px: x-tw/2,  py: y + th/2   - baseH };

  // Roof level (shifted up by totalH)
  const rBack  = { px: gBack.px,  py: gBack.py  - totalH };
  const rRight = { px: gRight.px, py: gRight.py - totalH };
  const rFront = { px: gFront.px, py: gFront.py - totalH };
  const rLeft  = { px: gLeft.px,  py: gLeft.py  - totalH };

  const {right: rightColor, left: leftColor} = getFaceColors(def);

  // RIGHT face (viewer-facing right side)
  ctx.beginPath();
  ctx.moveTo(rRight.px, rRight.py);
  ctx.lineTo(rFront.px, rFront.py);
  ctx.lineTo(gFront.px, gFront.py);
  ctx.lineTo(gRight.px, gRight.py);
  ctx.closePath();
  ctx.fillStyle = rightColor;
  ctx.fill();
  ctx.strokeStyle = 'rgba(0,0,0,0.18)';
  ctx.lineWidth = 0.5;
  ctx.stroke();

  // LEFT face (viewer-facing left side)
  ctx.beginPath();
  ctx.moveTo(rLeft.px,  rLeft.py);
  ctx.lineTo(rFront.px, rFront.py);
  ctx.lineTo(gFront.px, gFront.py);
  ctx.lineTo(gLeft.px,  gLeft.py);
  ctx.closePath();
  ctx.fillStyle = leftColor;
  ctx.fill();
  ctx.strokeStyle = 'rgba(0,0,0,0.18)';
  ctx.lineWidth = 0.5;
  ctx.stroke();

  // TOP face (roof diamond)
  ctx.beginPath();
  ctx.moveTo(rBack.px,  rBack.py);
  ctx.lineTo(rRight.px, rRight.py);
  ctx.lineTo(rFront.px, rFront.py);
  ctx.lineTo(rLeft.px,  rLeft.py);
  ctx.closePath();
  ctx.fillStyle = def.top;
  ctx.fill();
  ctx.strokeStyle = 'rgba(0,0,0,0.12)';
  ctx.lineWidth = 0.5;
  ctx.stroke();

  if(alpha !== undefined) ctx.globalAlpha = 1;
}

function drawGroundTile(c, r, hovered){
  const {tc, tr} = transformCoord(c, r);
  const {x, y} = isoToScreen(tc, tr);
  const tw = CONF.TILE_W, th = CONF.TILE_H;
  if(hovered){
    drawTopFace(x, y, tw, th, 'rgba(30,56,32,0.2)', 'rgba(30,56,32,0.5)');
  } else {
    drawTopFace(x, y, tw, th, 'rgba(30,28,24,0.04)', 'rgba(30,28,24,0.1)');
  }
}

// Compute painter's sort key: sum of transformed coords (back-to-front)
function sortKey(c, r) {
  const {tc, tr} = transformCoord(c, r);
  return tc + tr;
}

function renderScene(){
  const {W, H} = CONF;
  ctx.clearRect(0, 0, W, H);

  // Parchment bg
  ctx.fillStyle = '#f0ebe0';
  ctx.fillRect(0, 0, W, H);

  // Subtle grain
  ctx.fillStyle = 'rgba(30,28,24,0.025)';
  for(let i=0;i<600;i++){
    ctx.fillRect(((i*137.5)%W), ((i*97.3)%H), 1, 1);
  }

  // Collect all cells, sort back-to-front by transformed coords
  const allCells = [];
  for(let r=0; r<CONF.ROWS; r++){
    for(let c=0; c<CONF.COLS; c++){
      allCells.push({c, r, key: `${c},${r}`});
    }
  }
  allCells.sort((a, b) => sortKey(a.c, a.r) - sortKey(b.c, b.r));

  for(const {c, r, key} of allCells){
    const hov = hoveredCell && hoveredCell.col===c && hoveredCell.row===r;
    if(!grid[key]){
      drawGroundTile(c, r, hov);
    } else {
      // Draw ground tile first, then building
      drawGroundTile(c, r, false);
      const stack = grid[key];
      let stackOffset = 0;
      for(const item of stack){
        drawBuilding(c, r, item.type, undefined, stackOffset);
        stackOffset += TYPES[item.type].floors;
      }
    }
  }

  // Ghost preview on hover
  if(hoveredCell){
    const {col, row} = hoveredCell;
    const key = `${col},${row}`;
    if(col>=0 && col<CONF.COLS && row>=0 && row<CONF.ROWS){
      const stack = grid[key] || [];
      const stackOffset = stack.reduce((s,i)=>s+TYPES[i.type].floors, 0);
      drawBuilding(col, row, currentType, 0.38, stackOffset);
    }
  }
}

// ── Rotation with smooth animation
let rotAnimating = false;
let rotTarget = 0;
let rotCurrent = 0; // 0..3 as float for interpolation

function animateRotation(dir) {
  if(rotAnimating) return;
  rotAnimating = true;
  rotTarget = ((viewAngle + dir + 4) % 4);
  const startAngle = viewAngle;
  const startTime = performance.now();
  const duration = 380;

  function step(now) {
    const t = Math.min((now - startTime) / duration, 1);
    // Ease in-out cubic
    const ease = t < 0.5 ? 4*t*t*t : 1 - Math.pow(-2*t+2,3)/2;

    // During animation, interpolate origin Y to show "tilt"
    const baseY = CONF.H * 0.12;
    const dip = Math.sin(ease * Math.PI) * CONF.H * 0.04;
    CONF.ORIGIN_Y = baseY + dip;

    if(t >= 1) {
      viewAngle = rotTarget;
      CONF.ORIGIN_Y = baseY;
      rotAnimating = false;
      renderScene();
      return;
    }
    // Snap viewAngle at midpoint for seamless visual transition
    if(t >= 0.5 && viewAngle !== rotTarget) {
      viewAngle = rotTarget;
    }
    renderScene();
    requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

function getCanvasCell(e){
  const rect = canvas.getBoundingClientRect();
  const scaleX = CONF.W / rect.width;
  const scaleY = CONF.H / rect.height;
  const clientX = e.touches ? e.touches[0].clientX : e.clientX;
  const clientY = e.touches ? e.touches[0].clientY : e.clientY;
  const sx = (clientX - rect.left) * scaleX;
  const sy = (clientY - rect.top) * scaleY;
  return screenToWorld(sx, sy);
}

function placeBuilding(e){
  const {col, row} = getCanvasCell(e);
  if(col>=0 && col<CONF.COLS && row>=0 && row<CONF.ROWS){
    const key = `${col},${row}`;
    const shift = e.shiftKey || (e.touches && e.touches[0] && e.touches[0].force > 0.5);
    if(shift && grid[key] && grid[key].length > 0){
      if(grid[key].length < 6) grid[key].push({type:currentType});
    } else {
      grid[key] = [{type:currentType}];
    }
    renderScene();
  }
}

canvas.addEventListener('mousemove', e=>{
  hoveredCell = getCanvasCell(e);
  if(isDragging) placeBuilding(e);
  else renderScene();
});
canvas.addEventListener('mousedown', e=>{
  if(e.button===2) return;
  isDragging=true;
  placeBuilding(e);
});
canvas.addEventListener('mouseup', ()=>{isDragging=false;});
canvas.addEventListener('mouseleave', ()=>{hoveredCell=null;isDragging=false;renderScene();});
canvas.addEventListener('contextmenu', e=>{
  e.preventDefault();
  const {col,row}=getCanvasCell(e);
  const k=`${col},${row}`;
  if(grid[k] && grid[k].length>1) grid[k].pop();
  else delete grid[k];
  renderScene();
});

// Touch support
canvas.addEventListener('touchstart', e=>{e.preventDefault();isDragging=true;placeBuilding(e);},{passive:false});
canvas.addEventListener('touchmove', e=>{e.preventDefault();if(isDragging)placeBuilding(e);},{passive:false});
canvas.addEventListener('touchend', ()=>{isDragging=false;});

document.querySelectorAll('.room-btn').forEach(btn=>{
  btn.addEventListener('click',()=>{
    if(btn.id==='rotateLeft'){ animateRotation(-1); return; }
    if(btn.id==='rotateRight'){ animateRotation(1); return; }
    document.querySelectorAll('.room-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    currentType=btn.dataset.type;
  });
});
document.getElementById('resetCanvas').addEventListener('click',()=>{
  grid={};renderScene();
});

setCanvasSize();
renderScene();
window.addEventListener('resize',()=>{setCanvasSize();renderScene();});
</script>
</body>
</html>
